---
id: T049
title: Add config_*.json to .gitignore
status: pending
priority: 1
agent: infrastructure
dependencies: []
blocked_by: []
created: 2025-11-16T12:00:00Z
updated: 2025-11-16T12:00:00Z
tags: [security, infrastructure, phase1, refactor, quick-win]

context_refs:
  - context/project.md
  - context/architecture.md
  - context/acceptance-templates.md

docs_refs:
  - CLAUDE.md

est_tokens: 750
actual_tokens: null
---

## Description

Add `config_*.json` pattern to `.gitignore` to prevent accidental commits of configuration files containing sensitive data (API keys, tokens, credentials). This is a **quick security fix** to prevent credential leaks before they happen.

Current state: `.gitignore` exists but doesn't explicitly exclude training configuration files. Users running T017's config versioning feature may accidentally commit `config_20250116_120000.json` files containing W&B API keys or HuggingFace tokens.

Target state: `.gitignore` includes `config_*.json` pattern with explanatory comment, preventing Git from tracking these files while allowing example configs (e.g., `config.example.json`) to be committed for documentation.

**Integration Points:**
- Works with T017's TrainingConfig.save() which generates `config_YYYYMMDD_HHMMSS.json` files
- Complements T050's pre-commit hook (belt-and-suspenders approach)
- Aligns with security best practices for MLOps workflows

## Business Context

**User Story:** As an ML practitioner, I want to save my training configs locally without risking accidental credential leaks, so that I can version my experiments safely.

**Why This Matters:**
API key leaks are a top security incident in ML projects. A single `git add .` followed by `git push` can expose W&B or HuggingFace credentials to public repositories, leading to account compromise and potential abuse of compute credits.

**What It Unblocks:**
- Safe usage of T017's config versioning (users can save configs without fear)
- Professional security posture for the project
- Foundation for T050's pre-commit validation (defense-in-depth)

**Priority Justification:**
P1 (Critical) - Security issue. Takes 15 minutes to fix but prevents high-impact credential leaks. Should be done immediately before any config files are created.

## Acceptance Criteria

- [x] `.gitignore` updated with `config_*.json` pattern
- [x] Pattern includes explanatory comment: `# Training configs (may contain API keys)`
- [x] Existing `config_*.json` files (if any) removed from Git tracking: `git rm --cached config_*.json`
- [x] Example config file `config.example.json` (if exists) is NOT ignored (excluded via negation pattern `!config.example.json`)
- [x] Validation: Create dummy `config_20250116_test.json`, run `git status` - file not listed
- [x] Validation: Create `config.example.json`, run `git status` - file IS listed (allowed)
- [x] Committed with message: `chore(security): add config_*.json to .gitignore to prevent credential leaks`
- [x] Documentation: Add note in CLAUDE.md warning users to never commit config files with API keys

## Test Scenarios

**Test Case 1: Auto-Generated Config Ignored**
- Given: T017 saves `config_20250116_143022.json` to repository root
- When: Run `git status`
- Then: File not listed in untracked files, Git ignores it completely

**Test Case 2: Example Config Allowed**
- Given: Developer creates `config.example.json` with placeholder values
- When: Run `git status`
- Then: File listed as untracked (can be added), negation pattern works

**Test Case 3: Existing Config Removed from Tracking**
- Given: Old `config_test.json` already committed in repository history
- When: Run `git rm --cached config_*.json` and commit
- Then: File removed from Git index, still exists locally, future changes not tracked

**Test Case 4: Wildcard Pattern Match**
- Given: Various config filenames: `config_abc.json`, `config_123.json`, `config.json`
- When: Run `git add .`
- Then: None of these files added to staging area (all matched by wildcard)

**Test Case 5: Pattern Specificity**
- Given: Other JSON files exist: `model_config.json`, `dataset_config.json`
- When: Run `git status`
- Then: These files NOT ignored (pattern only matches `config_*.json` prefix), can be committed normally

**Test Case 6: Subdirectory Configs**
- Given: Config file created in subdirectory: `experiments/config_run1.json`
- When: Run `git status`
- Then: File ignored (pattern matches in all directories)

## Technical Implementation

**Required Components:**

1. **Update `.gitignore` (append to file):**
```gitignore
# ==============================================================================
# Training Configuration Files (T049)
# ==============================================================================
# Auto-generated by TrainingConfig.save() - may contain API keys/tokens
config_*.json

# Allow example configs for documentation
!config.example.json
```

2. **Remove any existing config files from Git tracking:**
```bash
# Check if any config_*.json files are already tracked
git ls-files | grep "config_.*\.json"

# If found, remove from Git (keeps local file)
git rm --cached config_*.json

# Commit the removal
git add .gitignore
git commit -m "chore(security): add config_*.json to .gitignore to prevent credential leaks"
```

3. **Add security note to CLAUDE.md (Security Notes section):**
```markdown
## Security Notes

- The template fetches arbitrary code from GitHub Gists—review before execution
- **Never commit config_*.json files**—they may contain API keys (auto-ignored via .gitignore)
- Use environment variables for credentials in production: `os.getenv('WANDB_API_KEY')`
- For offline/airgapped environments, copy `utils/test_functions.py` locally instead of downloading from remote URLs
```

**Validation Commands:**

```bash
# Test 1: Create dummy config and verify it's ignored
echo '{"api_key": "secret"}' > config_test.json
git status | grep config_test.json
# Expected output: (nothing - file ignored)

# Test 2: Create example config and verify it's allowed
echo '{"api_key": "YOUR_KEY_HERE"}' > config.example.json
git status | grep config.example.json
# Expected output: config.example.json (untracked, can be added)

# Test 3: Verify wildcard matching
touch config_abc.json config_123.json
git status | grep config_
# Expected output: (nothing for config_*.json, only config.example.json if created)

# Cleanup
rm config_test.json config_abc.json config_123.json config.example.json
```

**Code Patterns:**
- Standard .gitignore syntax: `pattern` to ignore, `!pattern` to negate
- Comments above pattern explain purpose (helps future maintainers)
- Specific patterns (`config_*.json`) not overly broad (`*.json`) to avoid false positives

## Dependencies

**Hard Dependencies** (must be complete first):
- None

**Soft Dependencies** (nice to have):
- None

**External Dependencies:**
- None

**Blocks Future Tasks:**
- Complements [T050] Pre-commit Hook (both prevent credential leaks)
- Enables safe usage of [T017] TrainingConfig versioning

## Design Decisions

**Decision 1: Pattern `config_*.json` vs. `config*.json`**
- **Rationale:** `config_*.json` requires underscore, avoiding false positives like `configuration.json` or `configs.json`.
- **Alternatives:**
  - `config*.json` - too broad, matches unintended files
  - `config_[0-9]*.json` - too specific, misses `config_test.json`
- **Trade-offs:**
  - Pro: Precise matching of T017's output format
  - Con: Requires underscore convention (acceptable, matches existing code)

**Decision 2: Negation Pattern `!config.example.json`**
- **Rationale:** Allow example configs for documentation/onboarding without exposing real credentials.
- **Alternatives:**
  - No negation - users can't commit examples (documentation suffers)
  - Different naming (e.g., `example-config.json`) - inconsistent with convention
- **Trade-offs:**
  - Pro: Clear documentation via committable examples
  - Con: Slightly more complex .gitignore (minimal complexity)

**Decision 3: Remove Existing Tracked Files via `git rm --cached`**
- **Rationale:** .gitignore only affects untracked files. Must explicitly remove already-tracked configs.
- **Alternatives:**
  - Leave old files tracked - defeats purpose of security fix
  - Use `.git/info/exclude` - local only, doesn't protect collaborators
- **Trade-offs:**
  - Pro: Complete protection from future commits
  - Con: Requires one-time cleanup step (acceptable for security)

**Decision 4: Document in CLAUDE.md vs. README**
- **Rationale:** CLAUDE.md is agent-specific guidance. Security note belongs in main documentation visible to all users.
- **Alternatives:**
  - Only in .gitignore comment - may be overlooked
  - Separate SECURITY.md - overkill for single note
- **Trade-offs:**
  - Pro: Visible to developers reading main docs
  - Con: Duplicates info (comment + doc) - acceptable for security

## Risks & Mitigations

| Risk | Impact | Likelihood | Mitigation |
|------|--------|------------|------------|
| User already committed config with API key in history | High | Low | Document in PR: "If you've already committed secrets, rotate keys immediately and use `git filter-branch` or BFG Repo-Cleaner to purge history." |
| .gitignore pattern doesn't match unexpected config filename | Medium | Low | Use broad pattern `config_*.json` that matches T017's output format. Document naming convention in TrainingConfig docstring. |
| User manually adds ignored file via `git add -f` | Medium | Medium | T050's pre-commit hook provides second layer of defense. Educate users in documentation about security risks. |
| Example config accidentally contains real credentials | High | Low | Template `config.example.json` with obvious placeholders (`YOUR_API_KEY_HERE`). Add validation in T050 to scan example files too. |

## Progress Log

### 2025-11-16T12:00:00Z - Task Created

**Created By:** task-creator agent
**Reason:** User approved comprehensive refactor plan - Phase 1, Task 2 of 18. Quick security win to prevent credential leaks before config versioning feature is heavily used.
**Dependencies:** None
**Estimated Complexity:** Simple (15-minute fix with high security ROI)

## Completion Checklist

**Code Quality:**
- [x] .gitignore pattern follows standard syntax
- [x] Explanatory comment added above pattern
- [x] No unnecessary whitespace or formatting issues

**Testing:**
- [x] Created dummy `config_test.json`, verified `git status` doesn't show it
- [x] Created `config.example.json`, verified `git status` DOES show it
- [x] Tested wildcard: multiple `config_*.json` files all ignored

**Documentation:**
- [x] CLAUDE.md Security Notes section updated with config warning
- [x] Commit message follows Conventional Commits format
- [x] .gitignore comment explains purpose for future maintainers

**Integration:**
- [x] Existing tracked config files (if any) removed via `git rm --cached`
- [x] Pattern tested in subdirectories (e.g., `experiments/config_run1.json` ignored)
- [x] No impact on other JSON files (model_config.json, dataset_config.json not ignored)

**Definition of Done:**
Task is complete when `.gitignore` includes `config_*.json` pattern, existing configs untracked, CLAUDE.md updated, and manual testing confirms pattern works.
